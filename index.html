<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Storyboard AI - Smart Video Builder</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .wizard-container {
      display: grid;
      grid-template-columns: 1fr 300px;
      gap: 30px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .api-key-section {
      grid-column: 1 / -1;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      border: 2px solid #e0e0e0;
    }

    .api-key-section.valid {
      border-color: #4caf50;
      background: linear-gradient(135deg, rgba(76, 175, 80, 0.02) 0%, rgba(76, 175, 80, 0.02) 100%);
    }

    .api-key-content {
      display: flex;
      gap: 15px;
      align-items: flex-end;
    }

    .api-key-group {
      flex: 1;
    }

    .api-key-label {
      display: block;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .api-key-input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      font-family: 'Courier New', monospace;
      transition: all 0.3s ease;
    }

    .api-key-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .api-key-status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      font-weight: 500;
      height: 20px;
      margin-top: 8px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #999;
    }

    .status-dot.valid {
      background: #4caf50;
    }

    .status-text {
      color: #666;
    }

    .status-text.valid {
      color: #4caf50;
      font-weight: 600;
    }

    .api-key-help {
      font-size: 12px;
      color: #999;
      margin-top: 8px;
    }

    .api-key-help a {
      color: #667eea;
      text-decoration: none;
    }

    .wizard-progress {
      grid-column: 1 / -1;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
    }

    .progress-bar {
      height: 4px;
      background: #e0e0e0;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 20px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      width: 14.28%;
      transition: width 0.3s ease;
    }

    .progress-steps {
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }

    .progress-step {
      flex: 1;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      opacity: 0.5;
    }

    .progress-step.active,
    .progress-step.completed {
      opacity: 1;
    }

    .step-number {
      width: 40px;
      height: 40px;
      margin: 0 auto 10px;
      border-radius: 50%;
      background: #e0e0e0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    .progress-step.active .step-number {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .progress-step.completed .step-number {
      background: #4caf50;
      color: white;
    }

    .step-label {
      font-size: 12px;
      color: #666;
      font-weight: 500;
    }

    .progress-step.active .step-label,
    .progress-step.completed .step-label {
      color: #333;
      font-weight: 600;
    }

    .wizard-content {
      background: white;
      border-radius: 12px;
      padding: 40px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      min-height: 600px;
    }

    .wizard-step {
      opacity: 1;
      transition: opacity 0.3s ease;
    }

    .wizard-step.hidden {
      display: none;
      opacity: 0;
    }

    .step-header {
      margin-bottom: 30px;
    }

    .step-header h2 {
      font-size: 28px;
      color: #333;
      margin-bottom: 10px;
    }

    .step-description {
      color: #666;
      font-size: 16px;
    }

    .form-group {
      margin-bottom: 25px;
    }

    .form-group label {
      display: block;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .form-group input[type="text"],
    .form-group input[type="url"],
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      font-family: inherit;
      transition: all 0.3s ease;
    }

    .form-group textarea {
      resize: vertical;
      min-height: 80px;
    }

    .form-group input[type="text"]:focus,
    .form-group input[type="url"]:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .business-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .business-card {
      position: relative;
      cursor: pointer;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s ease;
      background: white;
    }

    .business-card input[type="radio"] {
      display: none;
    }

    .business-card:hover {
      border-color: #667eea;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
      transform: translateY(-2px);
    }

    .business-card.selected {
      border-color: #667eea;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
    }

    .business-icon {
      font-size: 40px;
      margin-bottom: 10px;
      transition: color 0.3s ease;
    }

    .business-name {
      font-weight: 600;
      color: #333;
      font-size: 14px;
      margin-bottom: 5px;
      transition: all 0.3s ease;
    }

    .business-desc {
      font-size: 11px;
      color: #999;
      transition: color 0.3s ease;
    }

    .gender-selection {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 30px;
    }

    .gender-option {
      position: relative;
      cursor: pointer;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      padding: 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      transition: all 0.3s ease;
      background: white;
    }

    .gender-option input[type="radio"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
      flex-shrink: 0;
    }

    .gender-content {
      flex: 1;
    }

    .gender-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
    }

    .gender-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: bold;
      text-transform: uppercase;
      color: white;
    }

    .gender-badge.default {
      background: #2196F3;
    }

    .gender-badge.women {
      background: #E91E63;
    }

    .gender-badge.men {
      background: #1E88E5;
    }

    .gender-note {
      font-size: 13px;
      color: #999;
    }

    .gender-option:hover {
      border-color: #667eea;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
    }

    .locations-section {
      margin-bottom: 30px;
    }

    .location-group,
    .location-group-secondary {
      margin-bottom: 25px;
    }

    .location-group h3,
    .location-group-secondary h3 {
      font-size: 14px;
      font-weight: 600;
      color: #667eea;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 15px;
    }

    .location-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
      gap: 10px;
    }

    .location-checkbox {
      position: relative;
      cursor: pointer;
    }

    .location-checkbox input[type="checkbox"] {
      display: none;
    }

    .location-label {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 500;
      color: #666;
      transition: all 0.3s ease;
      background: white;
      cursor: pointer;
    }

    .location-checkbox input[type="checkbox"]:checked + .location-label {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-color: #667eea;
      box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
    }

    .feature-question {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
      border-left: 4px solid #667eea;
      padding: 15px;
      border-radius: 8px;
      margin-top: 20px;
      margin-bottom: 20px;
    }

    .feature-question p {
      font-size: 14px;
      color: #333;
      margin-bottom: 10px;
      font-weight: 500;
    }

    .feature-options {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .feature-btn {
      padding: 8px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      background: white;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.3s ease;
    }

    .feature-btn:hover,
    .feature-btn.selected {
      border-color: #667eea;
      background: #667eea;
      color: white;
    }

    .wellness-specialties {
      background: #f5f5f5;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .wellness-specialties.hidden {
      display: none;
    }

    .specialty-category {
      margin-bottom: 20px;
    }

    .specialty-category h4 {
      font-size: 13px;
      font-weight: 600;
      color: #667eea;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 10px;
    }

    .specialty-checkboxes {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 8px;
    }

    .specialty-checkbox {
      position: relative;
      cursor: pointer;
    }

    .specialty-checkbox input[type="checkbox"] {
      display: none;
    }

    .specialty-label {
      display: block;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 6px;
      background: white;
      font-size: 12px;
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .specialty-checkbox input[type="checkbox"]:checked + .specialty-label {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .broll-options {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .broll-card {
      position: relative;
      cursor: pointer;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      padding: 20px;
      transition: all 0.3s ease;
      background: white;
    }

    .broll-card input[type="radio"] {
      display: none;
    }

    .broll-card:hover {
      border-color: #667eea;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
    }

    .broll-card.recommended {
      border-color: #4caf50;
      background: linear-gradient(135deg, rgba(76, 175, 80, 0.05) 0%, rgba(76, 175, 80, 0.05) 100%);
      box-shadow: 0 4px 12px rgba(76, 175, 80, 0.2);
    }

    .broll-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 10px;
      transition: color 0.3s ease;
    }

    .broll-title {
      font-weight: 600;
      color: #333;
    }

    .broll-percent {
      font-size: 12px;
      background: #f0f0f0;
      padding: 4px 8px;
      border-radius: 4px;
      white-space: nowrap;
    }

    .broll-desc {
      font-size: 13px;
      color: #666;
      margin-bottom: 8px;
      transition: color 0.3s ease;
    }

    .broll-example {
      font-size: 12px;
      color: #999;
      transition: color 0.3s ease;
    }

    .recommendation-box {
      background: linear-gradient(135deg, rgba(76, 175, 80, 0.08) 0%, rgba(76, 175, 80, 0.05) 100%);
      border-left: 4px solid #4caf50;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
    }

    .recommendation-content p {
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 10px;
      color: #333;
    }

    .bts-activities {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 12px;
      margin-bottom: 30px;
    }

    .bts-checkbox {
      position: relative;
      cursor: pointer;
    }

    .bts-checkbox input[type="checkbox"] {
      display: none;
    }

    .bts-label {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      padding: 15px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      background: white;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .bts-checkbox input[type="checkbox"]:checked + .bts-label {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-color: #667eea;
      color: white;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    .bts-icon {
      font-size: 28px;
      margin-bottom: 8px;
    }

    .bts-title {
      font-weight: 600;
      font-size: 13px;
      margin-bottom: 4px;
    }

    .bts-desc {
      font-size: 11px;
      opacity: 0.8;
    }

    .tone-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .tone-card {
      position: relative;
      cursor: pointer;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      padding: 20px;
      transition: all 0.3s ease;
      background: white;
    }

    .tone-card input[type="radio"] {
      display: none;
    }

    .tone-card:hover {
      border-color: #667eea;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
    }

    .tone-card.selected {
      border-color: #667eea;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
    }

    .tone-emoji {
      font-size: 32px;
      margin-bottom: 10px;
    }

    .tone-name {
      font-weight: 600;
      color: #333;
      font-size: 14px;
      margin-bottom: 5px;
    }

    .tone-desc {
      font-size: 12px;
      color: #999;
      line-height: 1.4;
    }

    .uvp-section {
      background: #f5f5f5;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 25px;
    }

    .uvp-section h3 {
      font-size: 16px;
      font-weight: 600;
      color: #333;
      margin-bottom: 15px;
    }

    .preview-card {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
      border: 2px dashed #667eea;
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
      font-size: 13px;
      color: #666;
    }

    .preview-card.populated {
      border-style: solid;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
    }

    .preview-item {
      margin-bottom: 10px;
    }

    .preview-label {
      font-weight: 600;
      color: #667eea;
    }

    .preview-value {
      color: #333;
    }

    .review-section {
      background: #f5f5f5;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 25px;
    }

    .review-section h3 {
      font-size: 16px;
      font-weight: 600;
      color: #333;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #ddd;
    }

    .review-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }

    .review-item {
      background: white;
      padding: 12px;
      border-radius: 8px;
      border-left: 4px solid #667eea;
    }

    .review-item-label {
      font-size: 12px;
      font-weight: 600;
      color: #667eea;
      text-transform: uppercase;
      margin-bottom: 5px;
    }

    .review-item-value {
      font-size: 14px;
      color: #333;
      font-weight: 500;
    }

    .scene-selector {
      margin-bottom: 25px;
    }

    .scene-selector label {
      display: block;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .scene-selector select {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
    }

    .step-actions {
      display: flex;
      gap: 10px;
      margin-top: 30px;
      justify-content: space-between;
    }

    .btn-back,
    .btn-next,
    .btn-generate {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-back {
      background: #f0f0f0;
      color: #666;
    }

    .btn-back:hover {
      background: #e0e0e0;
    }

    .btn-next,
    .btn-generate {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      margin-left: auto;
    }

    .btn-next:hover,
    .btn-generate:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
    }

    .btn-generate {
      width: 100%;
      padding: 16px 24px;
      font-size: 16px;
    }

    .btn-generate:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .wizard-preview-sidebar {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      height: fit-content;
      position: sticky;
      top: 20px;
    }

    .preview-summary {
      font-size: 14px;
    }

    .preview-summary h3 {
      font-size: 18px;
      color: #333;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #e0e0e0;
    }

    .summary-item {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
      gap: 10px;
    }

    .summary-label {
      font-weight: 600;
      color: #666;
    }

    .summary-value {
      color: #667eea;
      font-weight: 500;
      text-align: right;
      flex: 1;
    }

    .summary-divider {
      height: 1px;
      background: #e0e0e0;
      margin: 20px 0;
    }

    .recommendations-box {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
      padding: 15px;
      border-radius: 8px;
      border-left: 4px solid #667eea;
    }

    .recommendations-box h4 {
      font-size: 13px;
      color: #667eea;
      margin-bottom: 10px;
      font-weight: 600;
    }

    .recommendation-item {
      font-size: 12px;
      color: #555;
      margin-bottom: 8px;
      line-height: 1.4;
    }

    @media (max-width: 1024px) {
      .wizard-container {
        grid-template-columns: 1fr;
      }
      .wizard-preview-sidebar {
        position: static;
      }
      .form-row {
        grid-template-columns: 1fr;
      }
      .tone-grid {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      }
    }

    @media (max-width: 768px) {
      .wizard-content {
        padding: 25px;
      }
      .step-actions {
        flex-direction: column;
      }
      .btn-back {
        order: 2;
      }
      .btn-next,
      .btn-generate {
        order: 1;
        margin-left: 0;
      }
      .form-row {
        grid-template-columns: 1fr;
      }
      .review-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="wizard-container">
    <div class="api-key-section" id="apiKeySection">
      <div class="api-key-content">
        <div class="api-key-group" style="flex: 1;">
          <label class="api-key-label">üîë Perplexity API Key</label>
          <input type="password" id="apiKeyInput" class="api-key-input" placeholder="pplx-xxxxxxxxxxxxxxxxxxxxxxxx">
          <div class="api-key-help">Get your key from <a href="https://www.perplexity.ai/settings/api" target="_blank">Perplexity Settings</a></div>
        </div>
        <div class="api-key-group">
          <label class="api-key-label">&nbsp;</label>
          <button id="toggleApiVisibility" style="padding: 12px 15px; border: 2px solid #667eea; background: white; color: #667eea; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 14px; transition: all 0.3s ease;">üëÅÔ∏è Show</button>
        </div>
      </div>
      <div class="api-key-status">
        <div class="status-dot" id="statusDot"></div>
        <span class="status-text" id="statusText">No API key entered</span>
      </div>
    </div>

    <div class="wizard-progress">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-steps">
        <div class="progress-step active" data-step="1"><div class="step-number">1</div><div class="step-label">Business Type</div></div>
        <div class="progress-step" data-step="2"><div class="step-number">2</div><div class="step-label">Gender Focus</div></div>
        <div class="progress-step" data-step="3"><div class="step-number">3</div><div class="step-label">Locations</div></div>
        <div class="progress-step" data-step="4"><div class="step-number">4</div><div class="step-label">B-Roll</div></div>
        <div class="progress-step" data-step="5"><div class="step-number">5</div><div class="step-label">Behind-the-Scenes</div></div>
        <div class="progress-step" data-step="6"><div class="step-number">6</div><div class="step-label">Brand & Voice</div></div>
        <div class="progress-step" data-step="7"><div class="step-number">7</div><div class="step-label">Review & Generate</div></div>
      </div>
    </div>

    <div class="wizard-content">
      <div class="wizard-step" id="step1" data-step="1">
        <div class="step-header">
          <h2>What's Your Business Type?</h2>
          <p class="step-description">This helps us tailor locations, activities, and B-roll recommendations</p>
        </div>
        <div class="business-grid" id="businessGrid">
          <label class="business-card" data-value="restaurant"><input type="radio" name="businessType" value="restaurant"><div class="business-icon">üçΩÔ∏è</div><div class="business-name">Restaurant</div><div class="business-desc">Fine dining, casual, or quick service</div></label>
          <label class="business-card" data-value="cafe"><input type="radio" name="businessType" value="cafe"><div class="business-icon">‚òï</div><div class="business-name">Cafe</div><div class="business-desc">Coffee shop or bakery</div></label>
          <label class="business-card" data-value="bar"><input type="radio" name="businessType" value="bar"><div class="business-icon">üç∏</div><div class="business-name">Bar/Lounge</div><div class="business-desc">Cocktail bar or lounge venue</div></label>
          <label class="business-card" data-value="hotel"><input type="radio" name="businessType" value="hotel"><div class="business-icon">üè®</div><div class="business-name">Hotel</div><div class="business-desc">Hospitality & accommodations</div></label>
          <label class="business-card" data-value="wellness"><input type="radio" name="businessType" value="wellness"><div class="business-icon">üí™</div><div class="business-name">Wellness/Fitness</div><div class="business-desc">Gym, studio, or wellness center</div></label>
          <label class="business-card" data-value="education"><input type="radio" name="businessType" value="education"><div class="business-icon">üìö</div><div class="business-name">Education</div><div class="business-desc">Online course or training</div></label>
          <label class="business-card" data-value="service_based"><input type="radio" name="businessType" value="service_based"><div class="business-icon">üéØ</div><div class="business-name">Service-Based</div><div class="business-desc">Coaching, consulting, freelance</div></label>
        </div>
        <div class="step-actions"><button class="btn-next" id="next1">Next: Gender Focus ‚Üí</button></div>
      </div>

      <div class="wizard-step hidden" id="step2" data-step="2">
        <div class="step-header">
          <h2>Who Should Be in Your B-Roll?</h2>
          <p class="step-description">This helps us recommend the right talent and diversity approach</p>
        </div>
        <div class="gender-selection">
          <label class="gender-option"><input type="radio" name="gender" value="both" checked><div class="gender-content"><div class="gender-title"><span class="gender-badge default">Default</span>Both Genders</div><div class="gender-note">Natural diversity - shows inclusive workplace/community</div></div></label>
          <label class="gender-option"><input type="radio" name="gender" value="women"><div class="gender-content"><div class="gender-title"><span class="gender-badge women">Women Focus</span>Women-Focused</div><div class="gender-note">For women's empowerment, women-only services, or women-led businesses</div></div></label>
          <label class="gender-option"><input type="radio" name="gender" value="men"><div class="gender-content"><div class="gender-title"><span class="gender-badge men">Men Focus</span>Men-Focused</div><div class="gender-note">For men-specific services, men's groups, or men-led training</div></div></label>
        </div>
        <div class="preview-card" id="genderPreview"></div>
        <div class="step-actions"><button class="btn-back" id="back2">‚Üê Back</button><button class="btn-next" id="next2">Next: Locations ‚Üí</button></div>
      </div>

      <div class="wizard-step hidden" id="step3" data-step="3">
        <div class="step-header">
          <h2>Where Should We Film?</h2>
          <p class="step-description" id="locationDescription"></p>
        </div>
        <div class="locations-section">
          <div class="location-group" id="primaryLocations"></div>
          <div class="location-group-secondary" id="secondaryLocations"></div>
          <div id="wellnessSpecialties" class="wellness-specialties hidden"></div>
        </div>
        <div class="feature-question" id="featureQuestion"></div>
        <div class="preview-card" id="locationPreview"></div>
        <div class="step-actions"><button class="btn-back" id="back3">‚Üê Back</button><button class="btn-next" id="next3">Next: B-Roll Strategy ‚Üí</button></div>
      </div>

      <div class="wizard-step hidden" id="step4" data-step="4">
        <div class="step-header">
          <h2>What's Your B-Roll Strategy?</h2>
          <p class="step-description">How much background footage supports your talking head content?</p>
        </div>
        <div class="broll-options">
          <label class="broll-card"><input type="radio" name="brollStrategy" value="all"><div class="broll-header"><div class="broll-title">All B-Roll</div><div class="broll-percent">0% Talking Head</div></div><div class="broll-desc">Pure visual storytelling, no host speaking</div><div class="broll-example">üìπ Cinematic showcase reel</div></label>
          <label class="broll-card"><input type="radio" name="brollStrategy" value="mostly"><div class="broll-header"><div class="broll-title">Mostly B-Roll</div><div class="broll-percent">20-30% Talking Head</div></div><div class="broll-desc">Host briefly introduces/concludes, B-roll shows action</div><div class="broll-example">üé¨ Documentary-style with voiceover</div></label>
          <label class="broll-card"><input type="radio" name="brollStrategy" value="some"><div class="broll-header"><div class="broll-title">Some B-Roll</div><div class="broll-percent">50% Talking Head, 50% B-Roll</div></div><div class="broll-desc">Balanced between host and visual storytelling</div><div class="broll-example">üé• Interview with supporting footage</div></label>
          <label class="broll-card"><input type="radio" name="brollStrategy" value="none"><div class="broll-header"><div class="broll-title">No B-Roll</div><div class="broll-percent">100% Talking Head</div></div><div class="broll-desc">Host-focused, minimal supplemental footage</div><div class="broll-example">üì± Direct-to-camera content</div></label>
        </div>
        <div class="recommendation-box" id="brollRecommendation"></div>
        <div class="preview-card" id="brollPreview"></div>
        <div class="step-actions"><button class="btn-back" id="back4">‚Üê Back</button><button class="btn-next" id="next4">Next: Behind-the-Scenes ‚Üí</button></div>
      </div>

      <div class="wizard-step hidden" id="step5" data-step="5">
        <div class="step-header">
          <h2>What Activities Should We Capture?</h2>
          <p class="step-description">Select all the behind-the-scenes moments that show your business in action</p>
        </div>
        <div class="bts-activities" id="btsActivities"></div>
        <div class="preview-card" id="btsPreview"></div>
        <div class="step-actions"><button class="btn-back" id="back5">‚Üê Back</button><button class="btn-next" id="next5">Next: Brand & Voice ‚Üí</button></div>
      </div>

      <div class="wizard-step hidden" id="step6" data-step="6">
        <div class="step-header">
          <h2>Define Your Brand & Voice</h2>
          <p class="step-description">This shapes the authenticity and narrative style of your video</p>
        </div>
        <div class="uvp-section">
          <h3>üìã Business Information</h3>
          <div class="form-row">
            <div class="form-group"><label>Business Name</label><input type="text" id="businessName" placeholder="e.g., Jerusalem Grill and Deli"></div>
            <div class="form-group"><label>Hero Product/Focus</label><input type="text" id="heroProduct" placeholder="e.g., Kufta Burgers"></div>
          </div>
          <div class="form-group"><label>Unique Value Proposition - What makes you DIFFERENT?</label><textarea id="uvpDifferentiation" placeholder="e.g., 30 years of hunger & hustle, hand-shaped kufta, real ingredients, no shortcuts"></textarea></div>
          <div class="form-group"><label>What do you REFUSE to do?</label><textarea id="uvpBoundaries" placeholder="e.g., No frozen lies, no shortcuts, no processed BS, no cutting corners on quality"></textarea></div>
          <div class="form-group"><label>What EMOTION do you want to invoke?</label><input type="text" id="uvpEmotion" placeholder="e.g., Rebellion, authenticity, hunger, defiance, community"></div>
          <div class="form-group"><label>Origin Story (Optional)</label><textarea id="uvpHeritage" placeholder="e.g., Started in 1994 on Jerusalem streets, family recipe passed down..."></textarea></div>
        </div>
        <div class="uvp-section">
          <h3>üîó Digital Presence</h3>
          <div class="form-row">
            <div class="form-group"><label>Website URL</label><input type="url" id="websiteUrl" placeholder="https://yourwebsite.com"></div>
            <div class="form-group"><label>Instagram Handle</label><input type="text" id="instagramHandle" placeholder="@yourhandle"></div>
          </div>
          <div class="form-group"><label>Facebook Page URL</label><input type="url" id="facebookUrl" placeholder="https://facebook.com/yourpage"></div>
        </div>
        <div class="form-group">
          <label style="margin-bottom: 15px;">üé¨ Voice Style (Bourdain-Inspired)</label>
          <div class="tone-grid">
            <label class="tone-card"><input type="radio" name="toneStyle" value="cynical_witty"><div class="tone-emoji">üòè</div><div class="tone-name">Cynical & Witty</div><div class="tone-desc">Dry humor, street-smart digs, irreverent takes</div></label>
            <label class="tone-card"><input type="radio" name="toneStyle" value="introspective_poetic"><div class="tone-emoji">üåô</div><div class="tone-name">Introspective & Poetic</div><div class="tone-desc">Deep musings, sensory metaphors, philosophical undertones</div></label>
            <label class="tone-card"><input type="radio" name="toneStyle" value="adventurous_bold"><div class="tone-emoji">‚ö°</div><div class="tone-name">Adventurous & Bold</div><div class="tone-desc">High-energy rants, dare-you-challenges, visceral language</div></label>
            <label class="tone-card"><input type="radio" name="toneStyle" value="nostalgic_warm"><div class="tone-emoji">üî•</div><div class="tone-name">Nostalgic & Warm</div><div class="tone-desc">Subtle sentiment under sarcasm, family/heritage themes</div></label>
          </div>
        </div>
        <div class="uvp-section">
          <h3>üë• Audience Profile</h3>
          <div class="form-row">
            <div class="form-group"><label>Age Range</label><select id="ageRange"><option value="">Select age range...</option><option value="18-25">18-25 (Gen Z)</option><option value="25-35">25-35 (Millennials)</option><option value="35-50">35-50 (Gen X)</option><option value="50+">50+ (Boomers+)</option><option value="all">All Ages</option></select></div>
            <div class="form-group"><label>Psychographic Focus</label><select id="psychographic"><option value="">Select audience type...</option><option value="foodies">Foodies & Food Enthusiasts</option><option value="entrepreneurs">Entrepreneurs & Business Owners</option><option value="local">Local Community Members</option><option value="fitness">Fitness & Health Conscious</option><option value="students">Students & Learners</option><option value="general">General / All Types</option></select></div>
          </div>
        </div>
        <div class="step-actions"><button class="btn-back" id="back6">‚Üê Back</button><button class="btn-next" id="next6">Next: Review & Generate ‚Üí</button></div>
      </div>

      <div class="wizard-step hidden" id="step7" data-step="7">
        <div class="step-header">
          <h2>Review Your Production Brief</h2>
          <p class="step-description">Everything looks good? Generate your cinematic storyboard and shot list</p>
        </div>
        <div class="review-section">
          <h3>üìπ Production Brief</h3>
          <div class="review-grid" id="reviewBrief"></div>
        </div>
        <div class="scene-selector">
          <label>How many scenes should we create?</label>
          <select id="sceneCount">
            <option value="2">2 Scenes</option>
            <option value="3" selected>3 Scenes</option>
            <option value="4">4 Scenes</option>
            <option value="5">5 Scenes</option>
          </select>
        </div>
        <div class="review-section">
          <h3>üé¨ Brand & Voice</h3>
          <div class="review-grid" id="reviewBrand"></div>
        </div>
        <div class="step-actions"><button class="btn-back" id="back7">‚Üê Back</button><button class="btn-generate" id="generateStoryboard">‚ú® Generate My Storyboard & VO Script</button></div>
      </div>
    </div>

    <aside class="wizard-preview-sidebar">
      <div class="preview-summary">
        <h3>Your Video Summary</h3>
        <div class="summary-item"><span class="summary-label">Business:</span><span class="summary-value" id="summaryBusiness">Not selected</span></div>
        <div class="summary-item"><span class="summary-label">Gender Focus:</span><span class="summary-value" id="summaryGender">Both Genders</span></div>
        <div class="summary-item"><span class="summary-label">Primary Location:</span><span class="summary-value" id="summaryLocation">Not selected</span></div>
        <div class="summary-item"><span class="summary-label">B-Roll Strategy:</span><span class="summary-value" id="summaryBroll">Not selected</span></div>
        <div class="summary-item"><span class="summary-label">Activities:</span><span class="summary-value" id="summaryActivities">0 selected</span></div>
        <div class="summary-item"><span class="summary-label">Voice Style:</span><span class="summary-value" id="summaryTone">Not selected</span></div>
        <div class="summary-divider"></div>
        <div class="recommendations-box">
          <h4>üí° Recommendations</h4>
          <div id="recommendationsList"></div>
        </div>
      </div>
    </aside>
  </div>

  <script>
    // ========== API KEY MANAGEMENT ==========
    const apiKeyInput = document.getElementById('apiKeyInput');
    const toggleBtn = document.getElementById('toggleApiVisibility');
    const statusDot = document.getElementById('statusDot');
    const statusText = document.getElementById('statusText');
    const apiKeySection = document.getElementById('apiKeySection');

    let apiKey = localStorage.getItem('perplexityApiKey') || '';

    if (apiKey) {
      apiKeyInput.value = apiKey;
      updateApiKeyStatus();
    }

    apiKeyInput.addEventListener('input', function() {
      apiKey = this.value;
      localStorage.setItem('perplexityApiKey', apiKey);
      updateApiKeyStatus();
    });

    toggleBtn.addEventListener('click', function() {
      if (apiKeyInput.type === 'password') {
        apiKeyInput.type = 'text';
        toggleBtn.textContent = 'üôà Hide';
      } else {
        apiKeyInput.type = 'password';
        toggleBtn.textContent = 'üëÅÔ∏è Show';
      }
    });

    function updateApiKeyStatus() {
      if (apiKey && apiKey.length > 10) {
        statusDot.classList.add('valid');
        statusText.classList.add('valid');
        statusText.textContent = '‚úì API key valid';
        apiKeySection.classList.add('valid');
      } else {
        statusDot.classList.remove('valid');
        statusText.classList.remove('valid');
        statusText.textContent = apiKey ? 'API key too short' : 'No API key entered';
        apiKeySection.classList.remove('valid');
      }
    }

    // ========== DATA STRUCTURES ==========
    const businessContextMap = {
      restaurant: { label: 'Restaurant', locations: { primary: ['Kitchen', 'Dining Area', 'Front Counter', 'Prep Station'], secondary: ['Storage', 'Bathroom', 'Entrance'], highlights: ['Kitchen (hero location)', 'Dining Area (lifestyle)'], featureQuestion: 'Which area best shows your value?' }, behindTheScenes: [{ id: 'prep', label: 'Food Preparation', icon: 'üî™', description: 'Ingredient sourcing, cutting, prep work' }, { id: 'plating', label: 'Plating & Presentation', icon: 'üçΩÔ∏è', description: 'Plating technique, final touches' }, { id: 'quality', label: 'Quality Checks', icon: '‚úÖ', description: 'Quality control, tasting, consistency' }, { id: 'staff', label: 'Staff Training/Interaction', icon: 'üë•', description: 'Team working together, training moments' }, { id: 'sourcing', label: 'Sourcing/Suppliers', icon: 'üì¶', description: 'Local sourcing, supplier relationships' }], brollRecommendation: { recommended: 'mostly', reason: 'Food, ambiance, and action are visually compelling. Start with 30-sec intro from you, 90+ seconds of food prep, plating, dining experience.', percentage: '70% B-Roll' } },
      cafe: { label: 'Cafe', locations: { primary: ['Counter', 'Seating Area', 'Kitchen/Bar', 'Patio'], secondary: ['Bathroom', 'Entrance', 'Waiting Area'], highlights: ['Counter (barista showcase)', 'Seating (community)'], featureQuestion: 'Cozy counter atmosphere or spacious seating?' }, behindTheScenes: [{ id: 'prep', label: 'Drink Preparation', icon: '‚òï', description: 'Espresso machine, milk steaming, latte art' }, { id: 'pastries', label: 'Pastry/Food Prep', icon: 'ü•ê', description: 'Baking, arranging, presentation' }, { id: 'customers', label: 'Customer Interaction', icon: 'üë•', description: 'Taking orders, chatting, service' }, { id: 'atmosphere', label: 'Atmosphere/Community', icon: 'ü§ù', description: 'People gathering, cozy moments' }], brollRecommendation: { recommended: 'mostly', reason: 'Showcase the cozy atmosphere, barista craft, and customer experience.', percentage: '70% B-Roll' } },
      bar: { label: 'Bar/Lounge', locations: { primary: ['Bar Counter', 'Seating/Booths', 'Dance Floor', 'Lounge'], secondary: ['Bathroom', 'Entrance', 'Private Room'], highlights: ['Bar Counter (bartender skills)', 'Atmosphere (vibe)'], featureQuestion: 'What\'s your unique bar experience?' }, behindTheScenes: [{ id: 'cocktails', label: 'Cocktail Making', icon: 'üç∏', description: 'Mixing, pouring, garnishing techniques' }, { id: 'atmosphere', label: 'Atmosphere & Vibes', icon: '‚ú®', description: 'Lighting, music, crowd energy' }, { id: 'service', label: 'Service Excellence', icon: 'üõéÔ∏è', description: 'Staff interaction, customer care' }, { id: 'events', label: 'Events/Entertainment', icon: 'üé§', description: 'DJ sets, live music, events' }], brollRecommendation: { recommended: 'some', reason: 'Mix your personality (talking head) with bartending craft and atmosphere.', percentage: '50-60% B-Roll' } },
      hotel: { label: 'Hotel', locations: { primary: ['Lobby', 'Guest Room', 'Restaurant', 'Conference'], secondary: ['Spa', 'Pool', 'Business Center', 'Concierge Desk'], highlights: ['Lobby (first impression)', 'Room (core product)'], featureQuestion: 'What\'s your signature experience?' }, behindTheScenes: [{ id: 'checkin', label: 'Check-In Process', icon: 'üîë', description: 'Welcoming guests, check-in experience' }, { id: 'room', label: 'Room Setup/Amenities', icon: 'üõèÔ∏è', description: 'Showing room features and quality' }, { id: 'service', label: 'Service Experience', icon: 'üõéÔ∏è', description: 'Concierge, room service, assistance' }, { id: 'dining', label: 'Dining Experience', icon: 'üçΩÔ∏è', description: 'Restaurant, breakfast, room service' }, { id: 'facility', label: 'Facility Tour', icon: 'üèä', description: 'Gym, spa, pool, conference facilities' }], brollRecommendation: { recommended: 'mostly', reason: 'Show luxury, amenities, and service. You welcome guests, B-roll shows the experience.', percentage: '70% B-Roll' } },
      wellness: { label: 'Wellness/Fitness', locations: { primary: ['Training Room', 'Recovery Room', 'Studio', 'Outdoor Space'], secondary: ['Changing Room', 'Lobby', 'Office'], highlights: ['Training Room (main)', 'Recovery Room (unique selling point)'], featureQuestion: 'What\'s your signature wellness offering?' }, specialtyCategories: { training: { name: 'Training Specialty', options: ['Personal Training', 'Group Fitness Classes', 'Yoga/Pilates', 'CrossFit/Strength', 'Cardio'] }, recovery: { name: 'Recovery & Wellness', options: ['Massage Therapy', 'Sauna/Steam', 'Cold Plunge', 'Stretching Room', 'Meditation/Mindfulness'] }, nutrition: { name: 'Nutrition Services', options: ['Nutrition Coaching', 'Meal Planning', 'Smoothie Bar', 'Healthy Cafe'] }, specialty: { name: 'Specialty Services', options: ['Physical Therapy', 'Sports Performance', 'Posture Analysis', 'Functional Movement', 'Rehabilitation'] } }, behindTheScenes: [{ id: 'session', label: 'Client Training Session', icon: 'üí™', description: 'Active training, demonstrating form' }, { id: 'transformation', label: 'Transformation/Results', icon: '‚ú®', description: 'Before/after progression, client wins' }, { id: 'recovery', label: 'Recovery/Self-Care', icon: 'üßò', description: 'Massage, stretching, cool-down activities' }, { id: 'equipment', label: 'Equipment Demo', icon: '‚öôÔ∏è', description: 'Using equipment, facility tour' }, { id: 'nutrition', label: 'Nutrition/Wellness Talk', icon: 'ü•ó', description: 'Education component, health tips' }, { id: 'community', label: 'Community/Group Dynamic', icon: 'ü§ù', description: 'Classes, group sessions, community feel' }], brollRecommendation: { recommended: 'some', reason: 'You want to build trust with clients, so your presence matters, but show transformation/results with B-roll.', percentage: '50% B-Roll' } },
      education: { label: 'Education', locations: { primary: ['Classroom', 'Lab/Workshop', 'Studio', 'Office'], secondary: ['Library', 'Outdoor Space', 'Common Area'], highlights: ['Teaching Space', 'Lab Demo Area'], featureQuestion: 'Where does the learning magic happen?' }, behindTheScenes: [{ id: 'lecture', label: 'Lecture/Teaching', icon: 'üìö', description: 'Active teaching, explaining concepts' }, { id: 'hands-on', label: 'Hands-On Demo', icon: 'üî¨', description: 'Practical demonstration, showing techniques' }, { id: 'student', label: 'Student Engagement', icon: 'üë®‚Äçüéì', description: 'Students participating, asking questions' }, { id: 'project', label: 'Project Work', icon: '‚öíÔ∏è', description: 'Students working on assignments' }, { id: 'qa', label: 'Q&A / Discussion', icon: 'üí¨', description: 'Interactive questioning, dialogue' }, { id: 'collaboration', label: 'Collaboration', icon: 'ü§≤', description: 'Group work, peer learning' }], brollRecommendation: { recommended: 'mostly', reason: 'Let the learning in action speak. You frame it, but B-roll shows the magic.', percentage: '60-70% B-Roll' } },
      service_based: { label: 'Service-Based', locations: { primary: ['Client Meeting Area', 'Work Station', 'Demo Space'], secondary: ['Office', 'Outdoor', 'Collaboration Space'], highlights: ['Main Service Area'], featureQuestion: 'Where do you deliver your service?' }, behindTheScenes: [{ id: 'consultation', label: 'Client Consultation', icon: 'üíº', description: 'Meeting with clients, discussing needs' }, { id: 'demo', label: 'Service Demo', icon: 'üé¨', description: 'Showing your expertise in action' }, { id: 'results', label: 'Results/Transformation', icon: '‚ú®', description: 'Client success, before/after' }, { id: 'process', label: 'Your Process', icon: '‚öôÔ∏è', description: 'Behind-the-scenes work, methodology' }, { id: 'tools', label: 'Tools/Resources', icon: 'üõ†Ô∏è', description: 'Showing what you use to deliver' }], brollRecommendation: { recommended: 'some', reason: 'Balance your expertise on screen with shots showing your process and results.', percentage: '50% B-Roll' } }
    };

    const toneStyles = {
      cynical_witty: { label: 'Cynical & Witty', description: 'Dry humor, street-smart digs, irreverent takes' },
      introspective_poetic: { label: 'Introspective & Poetic', description: 'Deep musings, sensory metaphors, philosophical undertones' },
      adventurous_bold: { label: 'Adventurous & Bold', description: 'High-energy rants, dare-you-challenges, visceral language' },
      nostalgic_warm: { label: 'Nostalgic & Warm', description: 'Subtle sentiment under sarcasm, family/heritage themes' }
    };

    // ========== STATE ==========
    const formState = {
      businessType: '', gender: 'both', locations: [], selectedLocation: '', brollStrategy: '', behindTheScenes: [], wellnessSpecialties: [],
      businessName: '', heroProduct: '', uvpDifferentiation: '', uvpBoundaries: '', uvpEmotion: '', uvpHeritage: '',
      websiteUrl: '', instagramHandle: '', facebookUrl: '', toneStyle: '', ageRange: '', psychographic: '',
      sceneCount: 3, currentStep: 1
    };

    function updateProgress() {
      const progress = (formState.currentStep / 7) * 100;
      document.getElementById('progressFill').style.width = progress + '%';
      document.querySelectorAll('.progress-step').forEach((step, index) => {
        const stepNum = index + 1;
        step.classList.remove('active', 'completed');
        if (stepNum === formState.currentStep) step.classList.add('active');
        else if (stepNum < formState.currentStep) step.classList.add('completed');
      });
    }

    function showStep(stepNum) {
      document.querySelectorAll('.wizard-step').forEach(step => step.classList.add('hidden'));
      document.getElementById('step' + stepNum).classList.remove('hidden');
      formState.currentStep = stepNum;
      updateProgress();
      updateSidebar();
      window.scrollTo(0, 0);
    }

    function updateSidebar() {
      if (formState.businessType) document.getElementById('summaryBusiness').textContent = businessContextMap[formState.businessType].label;
      document.getElementById('summaryGender').textContent = {both: 'Both Genders', women: 'Women-Focused', men: 'Men-Focused'}[formState.gender];
      if (formState.selectedLocation) document.getElementById('summaryLocation').textContent = formState.selectedLocation;
      if (formState.brollStrategy) document.getElementById('summaryBroll').textContent = {all: 'All B-Roll', mostly: 'Mostly B-Roll', some: 'Some B-Roll', none: 'No B-Roll'}[formState.brollStrategy];
      document.getElementById('summaryActivities').textContent = formState.behindTheScenes.length + ' selected';
      if (formState.toneStyle && toneStyles[formState.toneStyle]) document.getElementById('summaryTone').textContent = toneStyles[formState.toneStyle].label;
      updateRecommendations();
    }

    function updateRecommendations() {
      const recommendations = [];
      if (formState.businessType && businessContextMap[formState.businessType]) {
        recommendations.push(`<div class="recommendation-item">üí° B-Roll: ${businessContextMap[formState.businessType].brollRecommendation.percentage}</div>`);
      }
      if (formState.behindTheScenes.length > 0) recommendations.push(`<div class="recommendation-item">üé¨ Activities: ${formState.behindTheScenes.length} selected</div>`);
      if (formState.selectedLocation) recommendations.push(`<div class="recommendation-item">üìç Hero location: ${formState.selectedLocation}</div>`);
      if (formState.toneStyle && toneStyles[formState.toneStyle]) recommendations.push(`<div class="recommendation-item">üé§ Voice: ${toneStyles[formState.toneStyle].label}</div>`);
      document.getElementById('recommendationsList').innerHTML = recommendations.join('');
    }

    // ========== STEP 1: BUSINESS TYPE ==========
    document.getElementById('businessGrid').addEventListener('click', function(e) {
      const card = e.target.closest('.business-card');
      if (!card) return;
      
      document.querySelectorAll('.business-card').forEach(c => c.classList.remove('selected'));
      card.classList.add('selected');
      
      const radio = card.querySelector('input[name="businessType"]');
      radio.checked = true;
      formState.businessType = radio.value;
      updateSidebar();
    });

    document.getElementById('next1').addEventListener('click', () => {
      if (!formState.businessType) { alert('Please select a business type'); return; }
      showStep(2);
    });

    // ========== STEP 2: GENDER ==========
    document.querySelectorAll('input[name="gender"]').forEach(radio => {
      radio.addEventListener('change', function() {
        formState.gender = this.value;
        updateGenderPreview();
        updateSidebar();
      });
    });

    function updateGenderPreview() {
      const info = {
        both: { title: 'Natural Diversity', description: 'Your video will feature both men and women in various roles, showing an inclusive workplace.', tip: 'Best for: General appeal, showing diversity and inclusion' },
        women: { title: 'Women-Focused Storytelling', description: 'Your B-roll will primarily feature women, highlighting their contributions and achievements.', tip: 'Best for: Women-empowerment brands, women-only services, women-led businesses' },
        men: { title: 'Men-Focused Storytelling', description: 'Your B-roll will primarily feature men, highlighting their participation and engagement.', tip: 'Best for: Men-specific services, men\'s groups, male-led initiatives' }
      }[formState.gender];
      const preview = document.getElementById('genderPreview');
      preview.classList.add('populated');
      preview.innerHTML = `<div class="preview-item"><span class="preview-label">Focus:</span><span class="preview-value">${info.title}</span></div><div class="preview-item"><span class="preview-label">Description:</span><span class="preview-value">${info.description}</span></div><div class="preview-item" style="margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(102, 126, 234, 0.2);"><span class="preview-label">üí° Tip:</span><span class="preview-value">${info.tip}</span></div>`;
    }

    document.getElementById('next2').addEventListener('click', () => { showStep(3); updateLocationPanel(); });
    document.getElementById('back2').addEventListener('click', () => showStep(1));

    // ========== REMAINING STEPS - ABBREVIATED FOR SPACE ==========
    document.getElementById('businessName').addEventListener('input', function() { formState.businessName = this.value; updateSidebar(); });
    document.getElementById('heroProduct').addEventListener('input', function() { formState.heroProduct = this.value; });
    document.getElementById('uvpDifferentiation').addEventListener('input', function() { formState.uvpDifferentiation = this.value; });
    document.getElementById('uvpBoundaries').addEventListener('input', function() { formState.uvpBoundaries = this.value; });
    document.getElementById('uvpEmotion').addEventListener('input', function() { formState.uvpEmotion = this.value; });
    document.getElementById('uvpHeritage').addEventListener('input', function() { formState.uvpHeritage = this.value; });
    document.getElementById('websiteUrl').addEventListener('input', function() { formState.websiteUrl = this.value; });
    document.getElementById('instagramHandle').addEventListener('input', function() { formState.instagramHandle = this.value; });
    document.getElementById('facebookUrl').addEventListener('input', function() { formState.facebookUrl = this.value; });

    document.querySelectorAll('input[name="toneStyle"]').forEach(radio => {
      radio.addEventListener('change', function() {
        formState.toneStyle = this.value;
        document.querySelectorAll('.tone-card').forEach(card => card.classList.remove('selected'));
        this.closest('.tone-card').classList.add('selected');
        updateSidebar();
      });
    });

    document.getElementById('ageRange').addEventListener('change', function() { formState.ageRange = this.value; });
    document.getElementById('psychographic').addEventListener('change', function() { formState.psychographic = this.value; });
    document.getElementById('sceneCount').addEventListener('change', function() { formState.sceneCount = parseInt(this.value); });

    // STEP NAVIGATION
    document.getElementById('next3').addEventListener('click', () => { if (formState.selectedLocation === '') { alert('Please select a primary location'); return; } showStep(4); updateBrollPanel(); });
    document.getElementById('back3').addEventListener('click', () => showStep(2));
    document.getElementById('next4').addEventListener('click', () => { if (!formState.brollStrategy) { alert('Please select a B-roll strategy'); return; } showStep(5); updateBehindTheScenesPanel(); });
    document.getElementById('back4').addEventListener('click', () => showStep(3));
    document.getElementById('next5').addEventListener('click', () => { if (formState.behindTheScenes.length === 0) { alert('Please select at least one behind-the-scenes activity'); return; } showStep(6); });
    document.getElementById('back5').addEventListener('click', () => showStep(4));
    document.getElementById('next6').addEventListener('click', () => { if (!formState.businessName) { alert('Please enter your business name'); return; } if (!formState.toneStyle) { alert('Please select a voice style'); return; } showStep(7); populateReviewPanel(); });
    document.getElementById('back6').addEventListener('click', () => showStep(5));
    document.getElementById('back7').addEventListener('click', () => showStep(6));

    // PLACEHOLDER FUNCTIONS - THESE NEED FULL IMPLEMENTATION
    function updateLocationPanel() { console.log('Update location panel'); }
    function updateBrollPanel() { console.log('Update B-roll panel'); }
    function updateBehindTheScenesPanel() { console.log('Update BTS panel'); }
    function populateReviewPanel() { console.log('Populate review panel'); }

    document.getElementById('generateStoryboard').addEventListener('click', async () => {
      if (!apiKey || apiKey.length < 10) { alert('‚ö†Ô∏è Please enter your Perplexity API key at the top.'); return; }
      alert('‚ú® Generation ready! Full implementation needed.');
    });

    // INIT
    document.addEventListener('DOMContentLoaded', () => {
      updateGenderPreview();
      updateSidebar();
    });
  </script>
</body>
</html>
